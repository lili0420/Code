1.读取数据库信息：
import pandas as pd  # 导入数据统计模块
import pymysql  # 导入操作MySQL的模块
import sqlalchemy  # 导入sqlalchemy模块

# 使用pymysql连接数据库
pymysql_db = pymysql.connect(host="localhost", user="root", password="aa20030420", db="gxcvu3", port=3306,
                             charset="utf8")
# SQL查询语句，查询数据表中前5条书名信息
sql = "select news_title from news where id<=5"
# 通过read_sql_query()函数读取数据库信息
sql_query_data = pd.read_sql_query(sql=sql, con=pymysql_db)
print('通过read_sql_query()函数读取数据库信息如下',sql_query_data)
# 使用sqlalchemy连接数据库，依次设置（数据库产品名称+数据库操作模块名：//数据库用户名：密码@数据库ip地址：数据库端口号/数据库名称）
sqlalchemy_db=sqlalchemy.create_engine\
    ("mysql+pymysql://root:aa20030420@localhost:3306/gxcvu3")
# 通过read_sql_table()函数读取数据库信息
sql_table_data=pd.read_sql_table \
    (table_name='news',con=sqlalchemy_db)
print('\n')
print('通过read_sql_table()函数读取数据库信息长度为:',len(sql_table_data))
print('\n')
# 通过read_sql()函数读取数据库信息
read_sql_data=pd.read_sql(sql=sql,con=sqlalchemy_db)
print('通过read_sql()函数读取数据库信息如下',read_sql_data)



2.写入数据库信息
import pandas as pd  # 导入数据统计模块
import sqlalchemy  # 导入sqlalchemy模块
# 使用sqlalchemy连接数据库，依次设置（数据库产品名称+数据库操作模块名：//数据库用户名：密码@数据库ip地址：数据库端口号/数据库名称）
sqlalchemy_db=sqlalchemy.create_engine\
    ("mysql+pymysql://root:aa20030420@localhost:3306/gxcvu3")
# SQl查询语句
sql="select * from news"
# 模拟写入数据库中的数据
data={'A':[1,2,3,4,5],
      'B':[6,7,8,9,10],
      'C':[11,12,13,14,15]}
data_frame=pd.DataFrame(data) #创建DataFrame对象
# 向数据库中写入模拟数据data
data_frame.to_sql('to_sql_demo',sqlalchemy_db,if_exists='append')
# 通过read_sql()函数读取数据库信息
read_sql_data=pd.read_sql(sql=sql,con=sqlalchemy_db)
print(read_sql_data)

